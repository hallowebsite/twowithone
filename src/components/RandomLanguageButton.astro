---
import { Locales } from "@/i18n/ui";
import { useTranslations } from "@/i18n/utils";
import { getCollection } from "astro:content";
import { reorderSlugs, getNextSlug } from "@/helpers/languageChoiceHelpers";

const englishLanguages = await getCollection("languages", ({ id }) => {
  return id.startsWith("en/");
});
const germanLanguages = await getCollection("languages", ({ id }) => {
  return id.startsWith("de/");
});
const { currentSlug } = Astro.props;
const locale = currentSlug.split("/")[0];

const t = useTranslations(locale);

const languages = locale === Locales.de ? germanLanguages : englishLanguages;
const allLanguagesSlugs = languages.map((entry) => entry.slug);
const orderOfSlugsForToday = reorderSlugs(allLanguagesSlugs);
const nextSlug = getNextSlug(orderOfSlugsForToday, currentSlug);
---

<a
  role="button"
  id="randomLanguage"
  class="btn mb-4 mt-2 btn-primary btn-block btn-lg"
  href={`/${nextSlug}`}>{t("random.button")}</a
>
