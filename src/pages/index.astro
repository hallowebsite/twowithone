---
import { getCollection } from "astro:content";
import CountryBasic from "@/components/CountryBasic.astro";
import Layout from "@/layouts/Layout.astro";
import { getMatchingLocale } from "@/i18n/utils";
import { Locales } from "@/i18n/ui";

const englishLanguages = await getCollection("languages", ({ id }) => {
  return id.startsWith("en/");
});
const localesList = Astro.preferredLocaleList;
const localeToUse = getMatchingLocale(localesList);
if (localeToUse === Locales.de) {
  return Astro.redirect("/de");
}

const randomLanguage =
  englishLanguages[Math.floor(Math.random() * englishLanguages.length)];
---

<Layout title="Two with one">
  <CountryBasic language={randomLanguage} />
</Layout>
