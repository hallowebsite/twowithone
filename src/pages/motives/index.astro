---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import Motives from "@/components/Motives.astro";
import { useTranslations } from "@/i18n/utils.ts";
import { Locales } from "@/i18n/ui";

export const prerender = true;

const englishLanguages = await getCollection("languages", ({ id }) => {
  return id.startsWith("en/");
});
// create list of unuique tags togehter with a count of posts
const uniqueTagsWithCount = englishLanguages
  .flatMap((language) => language.data.tags)
  .reduce((acc: Record<string, number>, tag: string) => {
    if (acc[tag]) {
      acc[tag] += 1;
    } else {
      acc[tag] = 1;
    }
    return acc;
  }, {});
const t = useTranslations(Locales.de);
---

<Layout title="Motives">
  <main class="container p-4 mx-auto">
    <section
      class="overflow-x-auto container p-2 mt-12 max-w-screen-md mx-auto"
    >
      <h1 class="text-2xl text-center">Motives</h1>
      <div class="mt-8 p-8">
        <Motives tags={uniqueTagsWithCount} />
      </div>
    </section>
  </main>
</Layout>
